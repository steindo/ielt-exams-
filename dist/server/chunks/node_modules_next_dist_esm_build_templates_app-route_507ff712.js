module.exports=[18618,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),n=e.i(59756),s=e.i(61916),o=e.i(74677),i=e.i(69741),l=e.i(16795),c=e.i(87718),u=e.i(95169),p=e.i(47587),d=e.i(66012),m=e.i(70101),g=e.i(26937),h=e.i(10372),f=e.i(93695);e.i(52474);var R=e.i(220),E=e.i(89171);let v={systemPrompt:`You are an expert IELTS and TOEFL test preparation instructor with 15+ years of experience. 
You create high-quality, pedagogically sound exercises that:
- Follow official IELTS/TOEFL format and standards
- Target specific CEFR levels accurately
- Include clear, detailed explanations
- Use authentic, real-world language
- Progress logically in difficulty
- Avoid cultural bias and ambiguity`,grammarExercise:(e,t,r)=>`
Create ${r} grammar exercises for CEFR level ${e} on the topic: "${t}".

REQUIREMENTS:
1. **Format**: Mix of Multiple Choice (60%) and Gap-fill (40%)
2. **Difficulty**: Progressive - start easier, end harder
3. **Context**: Use realistic scenarios (work, travel, daily life, academic)
4. **Distractors**: For MCQ, make wrong answers plausible but clearly incorrect
5. **Explanations**: Include WHY the answer is correct AND why others are wrong

QUALITY STANDARDS:
- Natural, authentic English
- No ambiguous questions
- Clear, concise explanations
- Varied sentence structures
- Relevant vocabulary for the level

Return JSON array with this exact structure:
[
  {
    "id": "${e.toLowerCase()}-${t.toLowerCase().replace(/\s+/g,"-")}-1",
    "type": "MCQ" | "GapFill",
    "question": "Complete sentence or question",
    "options": ["option1", "option2", "option3", "option4"], // MCQ only
    "correctAnswer": 0 | "text",
    "explanation": "Detailed explanation with grammar rule",
    "difficulty": "easy" | "medium" | "hard",
    "tags": ["grammar-point", "topic"]
  }
]`,readingExercise:(e,t)=>`
Create ${t} reading comprehension exercises for CEFR level ${e}.

STRUCTURE:
1. One authentic passage (150-300 words for A1-A2, 300-500 for B1-B2)
2. ${t} questions based on the passage

PASSAGE REQUIREMENTS:
- Topic: Current events, science, culture, or everyday situations
- Appropriate vocabulary for ${e}
- Natural, engaging writing style
- Include context clues for vocabulary

QUESTION TYPES (mix these):
- Main idea / purpose
- Detail / specific information
- Inference / implication
- Vocabulary in context
- Author's tone / attitude (B1+)

Return JSON:
{
  "passage": {
    "title": "Engaging title",
    "text": "Full passage text",
    "wordCount": number,
    "level": "${e}",
    "topic": "topic category"
  },
  "questions": [
    {
      "id": "reading-${e.toLowerCase()}-1",
      "type": "MCQ",
      "question": "Question text",
      "options": ["A", "B", "C", "D"],
      "correctAnswer": 0,
      "explanation": "Why this answer, with reference to passage",
      "skill": "main-idea" | "detail" | "inference" | "vocabulary"
    }
  ]
}`,listeningExercise:(e,t)=>`
Create ${t} listening comprehension exercises for CEFR level ${e}.

AUDIO SCRIPT REQUIREMENTS:
- Dialogue or monologue (100-200 words)
- Natural conversational English
- Appropriate speed markers for ${e}
- Clear context and speakers

SCENARIOS (choose appropriate):
- Phone conversations
- Announcements (airport, train, public)
- Academic lectures (B1+)
- Casual conversations
- News reports (B2)

QUESTION TYPES:
- Specific information (numbers, names, places)
- Main purpose / topic
- Speaker's opinion / feeling
- Detail comprehension
- Inference from tone

Return JSON:
{
  "audioScript": {
    "title": "Scenario title",
    "speakers": ["Speaker 1", "Speaker 2"],
    "transcript": "Full dialogue with speaker labels",
    "duration": "estimated seconds",
    "level": "${e}"
  },
  "questions": [
    {
      "id": "listening-${e.toLowerCase()}-1",
      "type": "MCQ" | "GapFill",
      "question": "What does the speaker say about...?",
      "options": ["A", "B", "C", "D"],
      "correctAnswer": 0 | "text",
      "explanation": "Reference to specific part of audio",
      "timestamp": "0:45" // when answer appears
    }
  ]
}`,writingPrompt:(e,t)=>`
Create a writing task for IELTS/TOEFL ${t} at CEFR level ${e}.

${"task1"===t?`
TASK 1 (Academic Writing):
- Graph/Chart description OR Letter writing
- 150 words minimum
- 20 minutes suggested time
`:`
TASK 2 (Essay):
- Opinion/Discussion/Problem-Solution essay
- 250 words minimum
- 40 minutes suggested time
`}

PROMPT REQUIREMENTS:
- Clear, unambiguous question
- Relevant to ${e} vocabulary
- Authentic IELTS/TOEFL style
- Include specific instructions

ASSESSMENT CRITERIA:
- Task Achievement
- Coherence and Cohesion
- Lexical Resource
- Grammatical Range and Accuracy

Return JSON:
{
  "task": {
    "type": "${t}",
    "level": "${e}",
    "prompt": "Full writing prompt",
    "instructions": ["instruction 1", "instruction 2"],
    "wordCount": 150 | 250,
    "timeLimit": 20 | 40,
    "visualData": null | "chart/graph description" // for Task 1
  },
  "assessmentCriteria": {
    "taskAchievement": "What to evaluate",
    "coherence": "What to look for",
    "vocabulary": "Expected level",
    "grammar": "Expected structures"
  },
  "sampleAnswer": {
    "text": "Band 7-8 sample response",
    "bandScore": 7.5,
    "feedback": "Why this scores well"
  }
}`,speakingPrompt:(e,t)=>`
Create IELTS Speaking Part ${t} questions for CEFR level ${e}.

${1===t?`
PART 1 (Introduction & Interview):
- 4-5 minutes
- Familiar topics (home, family, work, hobbies)
- 3-4 questions per topic
- 2-3 topics total
`:2===t?`
PART 2 (Individual Long Turn):
- 3-4 minutes (1 min prep, 2 min talk)
- Cue card with topic and prompts
- Personal experience or description
`:`
PART 3 (Two-way Discussion):
- 4-5 minutes
- Abstract discussion related to Part 2
- Opinion, speculation, analysis
- 5-6 questions
`}

QUESTION REQUIREMENTS:
- Natural, conversational style
- Appropriate complexity for ${e}
- Encourage extended responses
- Build on previous answers (Part 3)

Return JSON:
{
  "part": ${t},
  "level": "${e}",
  "duration": "4-5 minutes",
  ${2===t?`
  "cueCard": {
    "topic": "Describe a...",
    "prompts": [
      "What it was",
      "When it happened",
      "Why it was important"
    ],
    "prepTime": "1 minute",
    "talkTime": "2 minutes"
  },
  `:`
  "questions": [
    {
      "id": "speaking-p${t}-${e.toLowerCase()}-1",
      "question": "Question text",
      "followUp": "Optional follow-up",
      "expectedLength": "2-3 sentences" | "extended response",
      "assessmentFocus": "fluency" | "vocabulary" | "grammar" | "pronunciation"
    }
  ],
  `}
  "assessmentCriteria": {
    "fluency": "What to evaluate",
    "vocabulary": "Expected range",
    "grammar": "Expected accuracy",
    "pronunciation": "Expected clarity"
  }
}`};async function w(e){try{let t,r,{exerciseType:a="grammar",level:n,topic:s,count:o=10,taskType:i,part:l}=await e.json();if(!n)return E.NextResponse.json({error:"Level is required"},{status:400});let c=process.env.OPENAI_API_KEY;if(!c)return E.NextResponse.json({error:"OpenAI API key not configured"},{status:500});switch(a){case"grammar":if(!s)return E.NextResponse.json({error:"Topic is required for grammar exercises"},{status:400});t=v.grammarExercise(n,s,o);break;case"reading":t=v.readingExercise(n,o);break;case"listening":t=v.listeningExercise(n,o);break;case"writing":if(!i)return E.NextResponse.json({error:"Task type (task1 or task2) is required for writing"},{status:400});t=v.writingPrompt(n,i);break;case"speaking":if(!l)return E.NextResponse.json({error:"Part (1, 2, or 3) is required for speaking"},{status:400});t=v.speakingPrompt(n,l);break;default:return E.NextResponse.json({error:"Invalid exercise type"},{status:400})}let u=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:v.systemPrompt},{role:"user",content:t}],temperature:.7,max_tokens:6e3,response_format:{type:"json_object"}})});if(!u.ok){let e=await u.json();return E.NextResponse.json({error:`OpenAI API error: ${e.error?.message||"Unknown error"}`},{status:u.status})}let p=await u.json(),d=p.choices[0]?.message?.content;if(!d)return E.NextResponse.json({error:"No content received from OpenAI"},{status:500});try{r=JSON.parse(d)}catch(e){return console.error("Failed to parse OpenAI response:",d),E.NextResponse.json({error:"Failed to parse exercises from AI response"},{status:500})}return E.NextResponse.json({success:!0,exerciseType:a,level:n,data:r,generatedAt:new Date().toISOString()})}catch(e){return console.error("Error generating advanced exercises:",e),E.NextResponse.json({error:"Internal server error"},{status:500})}}e.s(["POST",()=>w],10960);var x=e.i(10960);let y=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/generate-advanced/route",pathname:"/api/generate-advanced",filename:"route",bundlePath:""},distDir:"dist",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/generate-advanced/route.ts",nextConfigOutput:"",userland:x}),{workAsyncStorage:C,workUnitAsyncStorage:A,serverHooks:T}=y;function S(){return(0,a.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:A})}async function N(e,t,a){y.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let E="/api/generate-advanced/route";E=E.replace(/\/index$/,"")||"/";let v=await y.prepare(e,t,{srcPage:E,multiZoneDraftMode:!1});if(!v)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:w,params:x,nextConfig:C,parsedUrl:A,isDraftMode:T,prerenderManifest:S,routerServerContext:N,isOnDemandRevalidate:b,revalidateOnlyGenerated:I,resolvedPathname:k,clientReferenceManifest:P,serverActionsManifest:O}=v,$=(0,i.normalizeAppPath)(E),q=!!(S.dynamicRoutes[$]||S.routes[k]),U=async()=>((null==N?void 0:N.render404)?await N.render404(e,t,A,!1):t.end("This page could not be found"),null);if(q&&!T){let e=!!S.routes[k],t=S.dynamicRoutes[$];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await U();throw new f.NoFallbackError}}let D=null;!q||y.isDev||T||(D="/index"===(D=k)?"/":D);let F=!0===y.isDev||!q,M=q&&!F;O&&P&&(0,o.setManifestsSingleton)({page:E,clientReferenceManifest:P,serverActionsManifest:O});let L=e.method||"GET",_=(0,s.getTracer)(),j=_.getActiveScopeSpan(),H={params:x,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:F,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,n)=>y.onRequestError(e,t,a,n,N)},sharedContext:{buildId:w}},Q=new l.NodeNextRequest(e),B=new l.NodeNextResponse(t),W=c.NextRequestAdapter.fromNodeNextRequest(Q,(0,c.signalFromNodeResponse)(t));try{let o=async e=>y.handle(W,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=_.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${L} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${L} ${E}`)}),i=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var s,l;let c=async({previousCacheEntry:r})=>{try{if(!i&&b&&I&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(n);e.fetchMetrics=H.renderOpts.fetchMetrics;let l=H.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=H.renderOpts.collectedTags;if(!q)return await (0,d.sendResponse)(Q,B,s,H.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(s.headers);c&&(t[h.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,a=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:R.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await y.onRequestError(e,t,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:b})},!1,N),t}},u=await y.handleResponse({req:e,nextConfig:C,cacheKey:D,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:b,revalidateOnlyGenerated:I,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:i});if(!q)return null;if((null==u||null==(s=u.value)?void 0:s.kind)!==R.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",b?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),T&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let f=(0,m.fromNodeOutgoingHttpHeaders)(u.value.headers);return i&&q||f.delete(h.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||f.get("Cache-Control")||f.set("Cache-Control",(0,g.getCacheControlHeader)(u.cacheControl)),await (0,d.sendResponse)(Q,B,new Response(u.value.body,{headers:f,status:u.value.status||200})),null};j?await l(j):await _.withPropagatedContext(e.headers,()=>_.trace(u.BaseServerSpan.handleRequest,{spanName:`${L} ${E}`,kind:s.SpanKind.SERVER,attributes:{"http.method":L,"http.target":e.url}},l))}catch(t){if(t instanceof f.NoFallbackError||await y.onRequestError(e,t,{routerKind:"App Router",routePath:$,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:b})},!1,N),q)throw t;return await (0,d.sendResponse)(Q,B,new Response(null,{status:500})),null}}e.s(["handler",()=>N,"patchFetch",()=>S,"routeModule",()=>y,"serverHooks",()=>T,"workAsyncStorage",()=>C,"workUnitAsyncStorage",()=>A],18618)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_507ff712.js.map